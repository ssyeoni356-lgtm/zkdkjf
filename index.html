<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>사이트 인덱스</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h1 { font-size: 26px; margin-bottom: 1rem; }
        ul { list-style: none; padding-left: 0; }
        li { margin-bottom: 8px; }
        a { text-decoration: none; color: #007acc; }
        a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <h1>사이트 인덱스</h1>
    <ul id="index"></ul>

    <script>
        // 크롤러 함수
        async function crawl(url, visited) {
            if (visited.has(url)) return;
            visited.add(url);

            try {
                const res = await fetch(url);
                if (!res.ok) return;
                const html = await res.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, "text/html");

                // 링크 수집
                const links = doc.querySelectorAll("a[href]");
                links.forEach(link => {
                    let href = link.getAttribute("href");
                    // 상대경로 처리
                    if (href.startsWith("/zkdkjf")) {
                        href = new URL(href, url).href;
                    }
                    // 같은 도메인 내부만
                    if (href.startsWith(window.location.origin + "/zkdkjf")) {
                        if (!visited.has(href)) {
                            const li = document.createElement("li");
                            const a = document.createElement("a");
                            a.href = href;
                            a.textContent = href.replace(window.location.origin + "/zkdkjf", "");
                            li.appendChild(a);
                            document.getElementById("index").appendChild(li);

                            // 재귀적으로 페이지 크롤링
                            crawl(href, visited);
                        }
                    }
                });
            } catch (err) {
                console.error("크롤링 오류:", err);
            }
        }

        crawl(window.location.href, new Set());
    </script>
</body>
</html>

